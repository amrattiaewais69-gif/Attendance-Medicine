<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>UEC University Attendance System</title>

<script src="https://unpkg.com/html5-qrcode"></script>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>

body{
font-family:Poppins;
background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
color:white;
text-align:center;
margin:0;
height:100vh;
display:flex;
justify-content:center;
align-items:center;
}

.container{

width:420px;
background:rgba(255,255,255,0.1);
padding:25px;
border-radius:15px;

}

input,button{

width:100%;
padding:12px;
margin:8px 0;
border-radius:10px;
border:none;
font-size:15px;

}

button{

background:#00bcd4;
color:white;
cursor:pointer;

}

button:hover{

background:#0097a7;

}

.endBtn{

background:#ff5252;

}

.endBtn:hover{

background:#c62828;

}

.closeBtn{

background:#607d8b;

}

.closeBtn:hover{

background:#455a64;

}

#qr-reader{

margin-top:15px;

}

.success{

color:#4CAF50;

}

.error{

color:#ff5252;

}

.footer{

margin-top:15px;
opacity:0.7;
font-size:13px;

}

</style>

</head>

<body>


<div class="container" id="mainBox">

<h2>University of East Capital</h2>

<h3>Attendance System</h3>


<div id="setup">

<input id="lecturer" placeholder="Enter Lecturer Name">

<input id="course" placeholder="Enter Course Name">

<input id="group" placeholder="Enter Group Name">

<button onclick="startSession()">Start Session</button>

</div>


<div id="session" style="display:none">

<h3 id="sessionInfo"></h3>

<div id="qr-reader"></div>

<button class="endBtn" onclick="endSession()">End Session</button>

</div>


<div id="ended" style="display:none">

<h2>Session Ended</h2>

<button class="closeBtn" onclick="closeSystem()">

Close System

</button>

</div>


<div id="msg"></div>


<div class="footer">
Designed by UEC ICT Department<br>
<span style="font-size:12px; opacity:0.8;">
Â© 2026 University of East Capital. All Rights Reserved.
</span>
</div>


</div>



<audio id="successSound">

<source src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg">

</audio>

<audio id="errorSound">

<source src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg">

</audio>



<script>


const scriptURL="https://script.google.com/macros/s/AKfycbzaUJ3bzVbi3hd9E1fkBE1LnZdjzS4le9Ik-AxHeQ9jxlltEEgWo96MJPXnJgwcyLbV/exec";


let html5QrCode;

let lecturer,course,group;

let scanLock=false;

let scannedStudents=new Set();

let sessionActive=false;



function startSession(){


lecturer=document.getElementById("lecturer").value;

course=document.getElementById("course").value;

group=document.getElementById("group").value;


if(!lecturer||!course||!group){

alert("Enter all data");

return;

}


document.getElementById("setup").style.display="none";

document.getElementById("session").style.display="block";


document.getElementById("sessionInfo").innerHTML=

lecturer+"<br>"+course+" - "+group;


sessionActive=true;


html5QrCode=new Html5Qrcode("qr-reader");


html5QrCode.start(

{facingMode:"environment"},

{fps:10,qrbox:250},

onScanSuccess

);

}



function onScanSuccess(decodedText){


if(!sessionActive) return;

if(scanLock) return;


let studentId=decodedText.trim();


if(scannedStudents.has(studentId)){

showMsg("Already Registered","error");

playError();

return;

}


scanLock=true;


scannedStudents.add(studentId);


sendToSheet(studentId);


playSuccess();


showMsg("Registered: "+studentId,"success");


setTimeout(()=>{

scanLock=false;

},2000);


}



function sendToSheet(studentId){

fetch(scriptURL,{

method:"POST",

body:JSON.stringify({

lecturer,

course,

group,

student_id:studentId

})

});

}



function endSession(){


sessionActive=false;


html5QrCode.stop().then(()=>{


document.getElementById("session").style.display="none";

document.getElementById("ended").style.display="block";


});


}



function closeSystem(){


window.open('','_self');

window.close();


document.body.innerHTML="<h2>System Closed</h2>";

}



function showMsg(text,type){

let msg=document.getElementById("msg");

msg.innerHTML=text;

msg.className=type;

}



function playSuccess(){

document.getElementById("successSound").play();

}


function playError(){

document.getElementById("errorSound").play();

}



</script>


</body>

</html>
